@startuml
!include style.puml

box Model MODEL_COLOR_T1
participant ":AddressBook" as AddressBook MODEL_COLOR
participant ":Person" as Person MODEL_COLOR
participant ":Tag" as Tag MODEL_COLOR
participant "tags:UniqueTagList" as UniqueTagList MODEL_COLOR
end box

[-> AddressBook : setPersons(personList)
activate AddressBook
loop for each p in personList
    AddressBook -> Person : getTags()
    activate Person
    Person --> AddressBook : tagSet
    deactivate Person
    loop for personTag in tagSet
        alt personTag not in tagList
            AddressBook -> Tag : addTag(personTag)
            activate Tag
            Tag --> AddressBook
            deactivate Tag
    end
end
AddressBook -> UniqueTagList : setTags(tags)
activate UniqueTagList
UniqueTagList --> AddressBook
deactivate UniqueTagList
[<-- AddressBook

@enduml
